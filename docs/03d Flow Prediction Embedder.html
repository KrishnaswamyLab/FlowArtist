---

title: 03e Flow Prediction Network


keywords: fastai
sidebar: home_sidebar



nb_path: "03d Flow Prediction Embedder.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 03d Flow Prediction Embedder.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FlowPredictionDataset" class="doc_header"><code>class</code> <code>FlowPredictionDataset</code><a href="https://github.com/professorwug/FRED/tree/master/FRED/embed.py#L278" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FlowPredictionDataset</code>(<strong><code>X</code></strong>, <strong><code>velocities</code></strong>, <strong><code>labels</code></strong>, <strong><code>sigma</code></strong>=<em><code>'automatic'</code></em>, <strong><code>ts</code></strong>=<em><code>(1, 2, 4, 8)</code></em>, <strong><code>prior_embedding</code></strong>=<em><code>'diffusion map'</code></em>, <strong><code>t_dmap</code></strong>=<em><code>1</code></em>, <strong><code>dmap_coords_to_use</code></strong>=<em><code>2</code></em>) :: <code>Dataset</code></p>
</blockquote>
<p>Dataset object to be used with FRED for pointcloud and velocity input data.
Takes np.arrays for X (points) and velocities (velocity vectors per point).
For each item retrieved, returns a neighborhood around that point (based on local euclidean neighbors) containing local affinities</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Testing-the-new-dataset-class">Testing the new dataset class<a class="anchor-link" href="#Testing-the-new-dataset-class"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">FRED.datasets</span> <span class="kn">import</span> <span class="n">directed_spiral</span>
<span class="n">X</span><span class="p">,</span> <span class="n">flows</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">directed_spiral</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">FlowPredictionDataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">flows</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>finding diffusion operator
Set sigma =  0.20019817
Powering diffusion operator
computing diffusion distances
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">dataloader</span><span class="p">):</span>
    <span class="c1"># print(d)</span>
    <span class="k">pass</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>132491</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="The-Network">The Network<a class="anchor-link" href="#The-Network"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ManifoldFlowEmbedder" class="doc_header"><code>class</code> <code>ManifoldFlowEmbedder</code><a href="https://github.com/professorwug/FRED/tree/master/FRED/embed.py#L13" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ManifoldFlowEmbedder</code>(<strong><code>embedding_dimension</code></strong>=<em><code>2</code></em>, <strong><code>ts</code></strong>=<em><code>[1, 2, 4, 8]</code></em>, <strong><code>embedder_shape</code></strong>=<em><code>[3, 4, 8, 4, 2]</code></em>, <strong><code>device</code></strong>=<em><code>device(type='cpu')</code></em>, <strong><code>sigma</code></strong>=<em><code>0.5</code></em>, <strong><code>flow_strength</code></strong>=<em><code>0.5</code></em>, <strong><code>smoothness_grid</code></strong>=<em><code>True</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dps</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;points&quot;</span><span class="p">]</span>
<span class="n">dps</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[[-8.7701,  2.5721,  0.0000],
         [-9.1631,  1.4145,  0.0000]],

        [[-8.7701,  2.5721,  0.0000],
         [-9.2229,  1.1776,  0.0000]],

        [[-8.7701,  2.5721,  0.0000],
         [-9.2772,  0.9355,  0.0000]],

        ...,

        [[-9.3938,  0.2575,  0.0000],
         [-9.3979,  0.2269,  0.0000]],

        [[-9.3938,  0.2575,  0.0000],
         [-9.4027,  0.1899,  0.0000]],

        [[-9.3979,  0.2269,  0.0000],
         [-9.4027,  0.1899,  0.0000]]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dps</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">start_dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">end_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[-8.7701,  2.5721,  0.0000],
        [-9.1631,  1.4145,  0.0000],
        [-8.7701,  2.5721,  0.0000],
        ...,
        [-9.4027,  0.1899,  0.0000],
        [-9.3979,  0.2269,  0.0000],
        [-9.4027,  0.1899,  0.0000]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>


