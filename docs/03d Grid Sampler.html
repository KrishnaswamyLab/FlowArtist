---

title: 03d Grid Sampler


keywords: fastai
sidebar: home_sidebar

summary: "Sample points in the embedding space to further visualization."
description: "Sample points in the embedding space to further visualization."
nb_path: "03d Grid Sampler.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 03d Grid Sampler.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>FRED embeds a directed graph into a collection of points endowed with a vector field. But this vector field, by virtue of the FlowArtist, is defined not just on the points themselves, but everywhere in the embedding space (often $R^2$). This means that flow arrows, if left to their wn devices, might indicate deceptive directions of flow -- between the branches of a tree, or across the layers of a swiss roll.</p>
<p>One solution to this is allowing diffusion not only between the embedded datapoints, but also between points from a sampled grid on the embedding space. This allows the data to flow through gaps (of sparsity, say), and forces the flow to be accurate <em>everywhere</em>, not just on the sampled points. It's a way of training the flow where there isn't any data. As a side effect, we should expect the capacity for "flowing across the spiral" to encourage better geometric embeddings of the data.</p>
<p>Sadly, using such a grid is only practical in 2-3 dimensions. For much larger numbers, the curse of dimensionality causes the number of points required to evenly cover the entire embedding space to balloon too quickly to be practically incorporated into training.</p>
<p>But for visualization, which is only possible in 2-3 dimensions, the grid is a powerful way to make "following the flow" completely intuitive.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compute_grid" class="doc_header"><code>compute_grid</code><a href="https://github.com/professorwug/FRED/tree/master/FRED/embed.py#L463" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compute_grid</code>(<strong><code>X</code></strong>, <strong><code>grid_width</code></strong>=<em><code>20</code></em>)</p>
</blockquote>
<p>Returns a grid of points which bounds the points X.
The grid has 'grid_width' dots in both length and width.
Accepts X, tensor of shape n x 2
Returns tensor of shape grid_width^2 x 2</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A cornerstone of this method will be the powering of the diffusion matrix, which must intersperse jumping between points in the dataset and in the surrounding grid. Traditional matrix powering will do, provided we add the grid points to the dataset before powering, and then take them out afterwards.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="diffusion_matrix_with_grid_points" class="doc_header"><code>diffusion_matrix_with_grid_points</code><a href="https://github.com/professorwug/FRED/tree/master/FRED/embed.py#L491" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>diffusion_matrix_with_grid_points</code>(<strong><code>X</code></strong>, <strong><code>grid</code></strong>, <strong><code>flow_function</code></strong>, <strong><code>t</code></strong>, <strong><code>sigma</code></strong>, <strong><code>flow_strength</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This also reveals why our affinity matrix computation, by default, involves <em>two</em> pointsets.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">compute_grid</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">grid_width</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">GaussianVectorField</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">))</span>
<span class="n">flow_per_grid</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="c1"># visualize points and grid</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">A</span><span class="p">,</span><span class="n">grid</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">points</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># annotate by index</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">pt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">),</span><span class="n">pt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">grid</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">grid</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">flow_per_grid</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">flow_per_grid</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">diffusion_matrix_with_grid_points</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="c1"># power out a couple of times</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">detach</span><span class="p">())</span>
<span class="n">out</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXYAAAD4CAYAAAD4k815AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8qNh9FAAAACXBIWXMAAAsTAAALEwEAmpwYAAAyoElEQVR4nO3deXxU9fX/8ddJApiwBUgQSAggYlgkEIgIgooioriAuKKVL0VLacXv17II/tBabRWEWrdad1tbWtEqoCCKAnVDqUT2nbAmw76EJQlkO78/MhOTMMlMIJk7mZzn43EfzL3zmXvfOSQndz4zmSuqijHGmNAR5nQAY4wxVcsauzHGhBhr7MYYE2KssRtjTIixxm6MMSEmwqkDx8TEaNu2bZ06vDHG1Eg//vjjIVWNrWiMY429bdu2pKamOnV4Y4ypkURkl68xPqdiRORtETkgIuvKuV9E5EURSRORNSLS42zCGmOMqRr+zLH/DbiugvuvBzq4l9HAK+ceyxhjzNny2dhV9WvgSAVDhgB/1yLLgGgRaVlVAY0xxlROVbwrJg5IL7Ge4d52BhEZLSKpIpJ68ODBKji0McaYsqqisYuXbV4/gEZVX1fVFFVNiY2t8EVdY4wJabm5udW276p4V0wG0LrEejywpwr2e4a5K13MWLiZPZk5tIqOZOKgRIYmx/HBBx9w8803U7du3eo4bI3mrWYpsUpMTAznnXee0/GCjrd6JTfNJyEhARFv5zC1W9l63daugOFXdqVFixZORwtKJeuV+907PDByOP9v1C1VfpyqOGP/GBjhfndMb+CYqu6tgv2WMneli0dmr8WVmYMCrswcHpm9lrkrXcybN49u3bqxZMmSqj5sjVZezf65eAXJycl8//33TkcMKuXV63cvvs3tt9/OkSMVvdRU+3ir13Mf/UDnrt346quvnI4XdMrW60RWDo+OvoP/+/0LVX4sf97u+C7wPZAoIhkicp+IjBGRMe4hC4DtQBrwBvDrKk8JzFi4mZy8AgBOrl3E3n+MZ8/ivzLl5Xfp1q0bmzZtYsCAAQwfPhyXy1UdEWocT81ydq5i38yJHFv2b47t2c6cnWFs2rSJvn37MmHCBHJycpyOGhQ89co7nMHev4/n+PK5nDi8n+8PhPPhhx+SlJRkJw8leOpVcOok+2Y+zImVC8iVCI4eOsCAAQOYPn069rHgP/HUSwsLOPDv35G7fztakM+Lv32IRx99lMLCwqo7mKo6svTs2VMro+2k+drGvUR1ulIpmsf3ujRo0ECfffZZzc3NrdQxQo2nZg173FiqPhGNz9eIiIji9Q4dOug333zjdFzHeerVuN89pepVp2l88W0R0YcfflhPnz7tdFzHeerV9Npf/1QvCStVuyFDhujRo0edjhoUPPWKGTLZa9+67bbbNCsry+d+gFT10V9rzGfFtIqOLL5dp1k8dWLbljv25MmTjB8/nh49evD1118HIF1w8tQsvGEMEU1+egdq/rH95OfnF69v3bqVK664goceeoisrKyA5wwWnnqF1atPeKPmxdvzjmQU31ZVpk+fTp8+fdi8eXPAMwaT4p9JCSO8YUzRbS191vnRRx+RkpLCqlWrAhsuCHnqpfm5hEU1PuP+Dz74gCuvvJK9e899JrvGNPaJgxKJrBMOQHTf4bQa9Wcu/M27/PKRp8t9zLp167jyyiu599572bdvX6CiBg1PzRr3vo1Wv3idVve/QuyA+2jUpNkZY1WVF154gaSkpFo7P+qpV6OUm4kb8xYtfvZHopOv9zp2xYqi1ylef/31Wjvd4KlXw+7XETfmLZoM+IXXcdu2baNPnz68/fbbAU4YXDz1Co9qjObneR2TmppKr169zvkXYY1p7EOT45g6rCtx0ZEIEBcdyR9uT2HtV/N9PnbmzJkkJiby0ksvlTpTDXUlaxYmQtv2F3HX5V04fvRwuY/Zvn07/fv3Z+zYsZw8eTKAaZ1Xtl5tOnQkPjyz3PE5OTn88pe/ZNiwYRw6dChwQYNEyXrl7UvjxPfvlTv21KlT3Hfffdx333219jWdoclx/LxDHsf/8waaX/5bHTMyMujXrx8ff/zxWR9LnDrbSElJ0XP9ELAFCxawePFioqKiqF+/PlFRUV6Xkvc1b96cevXqVdFXUbOsX7+eBx54gIKCguKzzJL//2W3tWvXjj/+8Y+0atUq8GGDwLRp0/j000/JyckpXrKzs4tvnz59unhsy5Yteeeddxg4cKCDiZ2hqvzzn/9k165dHDlyhMOHD3v9t6Cg6M0P3bt354MPPqB9+/YOJ3dOYWEh+/fvZ9euXezevZvdu3cX3/b8m5mZyfTp0xk/fnypt9qKyI+qmlLR/mt0YzfGSYWFhaWa/qlTp2jfvj1hYTXmiXDAqCrHjx8vbvSFhYX06tXL6VhB7cSJE+zevZs2bdrQoEGD4u3W2I0xJsT409jt1MIYY0KMNXZjjAkx1tiNMSbEWGM3xpgQY43dGGNCjDV2Y4wJMdbYjTEmxFhjN8aYEGON3RhjQow1dmOMCTF+NXYRuU5ENotImohM9nJ/ExGZIyJrROQHEbm46qMaY4zxhz+XxgsHXgauBzoDw0Wkc5lh/w9YpapJwAig6i/iZ4wxlfDZZ5+RmJjIhRdeyLRp05yOE1D+nLH3AtJUdbuq5gKzgCFlxnQGFgOo6iagrYicX6VJjTHGTwUFBTzwwAN8+umnbNiwgXfffZcNGzY4HStg/GnscUB6ifUM97aSVgPDAESkF9AGiC+7IxEZLSKpIpJ68ODBs0tsjDE+/PDDD1x44YVccMEF1K1bl7vuuouPPvrI6VgB409jFy/byn7W7zSgiYisAh4EVgJnXKpIVV9X1RRVTYmNja1sVmOM8YvL5aJ169bF6/Hx8bhcLgcTBVaEH2MygNYl1uOBPSUHqOpx4OcAUnSpjx3uxRhjAmLuShczFm5mT2YOddPXkpBd+sLsJa9CFOr8OWNfDnQQkXYiUhe4Cyh1MT4RiXbfB3A/8LW72RtjTLWbu9LFI7PX4srMQYHjYQ35fs0W5q4sOkvPyMioVZd49NnYVTUfGAssBDYC76vqehEZIyJj3MM6AetFZBNF7575v+oKbIwxZc1YuJmcvILi9botL+L0YRe/f/dLcnNzmTVrFjfffLODCQPLn6kYVHUBsKDMtldL3P4e6FC10Ywxxj97MnNKrUtYOE0HjmHNmw/T6cPfMmrUKLp06eJQusDzq7EbY0wwaxUdiatMc49sfwm9el7B0slXO5TKOfaRAsaYGm/ioEQi64SX2hZZJ5yJgxIdSuQsO2M3xtR4Q5OL/rTG866YVtGRTByUWLy9trHGbowJCUOT42ptIy/LpmKMMSbEWGM3xpgQY43dGGNCjDV2Y4wJMdbYjTEmxFhjN8aYEGON3RhjQow1dmOMCTHW2I0xJsRYYzfGmBBjjd0YY0KMNXZjjAkxfjV2EblORDaLSJqITPZyf2MRmSciq0VkvYj8vOqjGmOM8YfPxi4i4cDLFF3yrjMwXEQ6lxn2ALBBVbsB/YFnS1wD1RhjTAD5c8beC0hT1e2qmgvMAoaUGaNAQym6DHgD4AiQX6VJjTHG+MWfxh4HpJdYz3BvK+nPFF3Qeg+wFvg/VS0suyMRGS0iqSKSevDgwbOMbIwxpiL+NHbxsk3LrA8CVgGtgO7An0Wk0RkPUn1dVVNUNSU2NraSUY0xxvjDnysoZQCtS6zHU3RmXtLPgWmqqkCaiOwAOgI/VElKt7krXT4vfbVp0yYKCwvp3LnsywC1kz81y87OJioqyqGEwcWfehUUFBAeHl7OHmoXX/U6duwYjRs3djBhcCmvXt999x0tWrTgggsuqJLj+HPGvhzoICLt3C+I3gV8XGbMbmAAgIicDyQC26skodvclS4emb0WV2YOp/ZuYdOXc/jNKx/zYeruUuMaNWpEUlISo0ePZu/evVUZocbx1Gznju2cWPM5u3bt4pHZa5m70lVq3Pjx43nuuefIz6/dL4t46rV7736Or/6cXekZXut19913s2bNGodSBg9PvTIOn+D4qs+81uuee+7h3Xffpeicr3YrrtfRbE6s+YJd6enF9crKyqJbt268/fbbVVMrVfW5AIOBLcA2YIp72xhgjPt2K+BziubX1wE/87XPnj17amVcNnWxtpk0X9tMmq8NLxmqFE0HaVjdSO3fv79OmjRJZ8+erS6XSxMTExXQ+vXr6+OPP64nTpyo1LFChadm0f1HFdcrIrqlnn/JDTpr1izdv3+/qqq+8MILCmhSUpJ+++23Dqd2jqdezW4cX1yvuue31/ir7tGlS5dqfn6+qqoOGTJEIyIi9NFHH9VTp045nNo5nno1v/MPP9Wr5UWaMOg+Xb9+vRYWFuqoUUXfe8OGDSv+fqutPPVqOerl4nrVi+ukbQeP0a+++qp425AhQyqsFZCqvnq2rwHVtVS2sbd1N/U2k+breW2SiovgbQkLCyu13qJFC33ttdc0Ly+vUses6Tw1i7yoT7m16tq1q95www2lto0cOVIPHDjgdPyA89SrfteBXmvVtGlTHT58uF599dXF2zp16qRLly51OrojPPVqdOmtXuvVoUMHTU5OLl6PiYnR999/3+nYjvHUK7r/yAr7F6DNmzfXjz/+2Ot+/Gnsog49RUpJSdHU1FS/x/edtgRXZg4AWlhA3qHdnN6zmYjD24jN2c2GDRt8PoXp3LkzzzzzDDfccANF78wMbZ6aaWEBufvSOLVrNad2reK0ayOan1fhY5s0acLUqVO5//77a818csl6nd6zhZztqeRsW07egYpnFUWEsWPH8vTTT9OgQYMApXXeGfVKW0b21mXkH3FV+Lg777yTP//5z8TExAQoaXAorpcWkrtnC9lbviNr81IKju0v9zG/+MUv+NOf/lTq+0pEflTVlIqOVWMau2d+KievoHhbZJ1wpg7rytDkOI4fP05qaiqvvfYa77//foX76t+/P3/84x/p2bPnWeevCcqr2RM3dCAmexdLlixh8eLF/Pe//y33l+Ill1zCK6+8EvK1gvLrNaFfDGSsZsGCBXzxxRecOHHC6+MTEhJ47bXXuO666wIV2VHl1euB5EhObvme9957j1WrVnl9bPPmzXnttdcYOnRoYMIGAW/1Oi8ijDtbHuHph0aW+xpX+/bt+cc//kGfPn0A/xp7jZmKUVWdsyJDL5u6WNtOmq+XTV2sc1ZklLrf5XJpixYtKnyKU69ePY2Pj9fk5GT929/+poWFhZXOUZP4qtl7773n82mhiOgDDzygR48edeaLCKCK6lVYWKi//vWvfdbr3nvv1UOHDjn4VQROefU6efKkXn755T5rdc899+jhw4cd/ioCp2y93lm8RpOSKp5axj29/Oijj2pubm5oTcX4Y/r06WzdupXY2FhiYmKIiYkpvu35t379+rViGsYf33zzDddccw0FBQVERUURFRVFZGQkkZGRXm+3a9eOyZMn06jRGX+iUCv87ne/44knnvBrbGxsLC+99BJ33HFHrft+Kygo4Oc//zmfffYZhYWFFBQUUFhYWOp2yW0tW7bk9ddf58Ybb3Q6esAtWbKElStXkpuby+nTp0v9621bUlISTz/9dOhMxZiql5OTQ0REBHXq1HE6StBTVdLT0wkLCyMsLIzw8PBS/5Z3W0RqXWOvDM8ZZkFBgX0f+smfqRh//kDJhKjIyEinI9QYIkJCQoLTMUKO5xdfWJh9gnhVsmoaU4MVFBSQnJxcK6cxTPmssRtTg73wwgt06tTJ6RgmyFhjN6aGysjI4JNPPuH+++93OooJMtbYjamhHnroIaZPn27z0+YM9uKpMTWI59MB01K/QjLySA9rQTTe/2DK1F7W2I2pIUr+5eIp1way1i/l9qt60CBCOZ19kp/97GfMnDnT6ZgmCFhjN6aGmLFwc/Gfoze5ciRNrhwJQIMjm2m7Z4k1dVPMJueMqSH2uD8Er6xDJ08HOIkJdtbYjakhWkV7/4Oy9kmXMn/+/ACnMcHMGrsxNcTEQYlE1in9EcqRdcKZOCjRoUQmWPnV2EXkOhHZLCJpIjLZy/0TRWSVe1knIgUi0rTq4xpTew1NjmPqsK7ERUciQFx0ZPHHVhtTks8PARORcIouizeQogtbLweGq+qGcsbfBPxGVa+uaL/2IWDGGFN5/nwImD9n7L2ANFXdrqq5wCxgSAXjhwPv+h/TGGNMVfKnsccB6SXWM9zbziAiUcB1wIfnHs0YY8zZ8Kexe/sw6fLmb24ClqrqEa87EhktIqkiknrw4EF/MxpjjKkEfxp7BtC6xHo8sKecsXdRwTSMqr6uqimqmhIbG+t/SmOMMX7zp7EvBzqISDsRqUtR8/647CARaQxcCXxUtRGNMcZUhs+PFFDVfBEZCywEwoG3VXW9iIxx3/+qe+gtwOeqmlVtaY0xxvhk1zw1xpgapKre7miMMaYGscZujDEhxhq7McaEGGvsxhgTYqyxG2NMiLHGbowxIcYauzHGhBhr7MYYE2KssRtjTIixxm6MMSHGGrsxxoQYa+zGGBNirLEbY0yIscZujDEhxhq7McaEGGvsxhgTYqyxG2NMiPGrsYvIdSKyWUTSRGRyOWP6i8gqEVkvIl9VbUxjjDH+8nnNUxEJB14GBgIZwHIR+VhVN5QYEw38BbhOVXeLSPNqymuMMcYHf87YewFpqrpdVXOBWcCQMmPuBmar6m4AVT1QtTGNMcb4y+cZOxAHpJdYzwAuLTPmIqCOiHwJNAReUNW/l92RiIwGRgMkJCRUOuzclS5mLNzMnswcWkVHMnFQIkOT47yOVVVEpNLHCDWVqZmxelWW1atyfNUrLy+POnXqnPNx/Dlj99Ydtcx6BNATuAEYBDwmIhed8SDV11U1RVVTYmNjKxV07koXj8xeiyszh4LT2WQcPs4js9cyd6XL6/j09HTuuOMO1q9fX6njhBJPzTIOHaOwIA9XZk6FNfv+++/Jy8sLcMrgUVyvIycpzK+4XqrK9u3bHUgZPIrrdTSbgrzT5dYrLy+PefPmOZQyeJTqYXmnvNZr7NixzJw5E9WyLbZy/GnsGUDrEuvxwB4vYz5T1SxVPQR8DXQ7p2RlzFi4mZy8AgBO/DiP3X+6jW2v/YpfjPofZsyYwcKFC9m3b19xQRISEli/fj1du3bl7rvvZvPmzVUZp0bw1Cxr81LSn7+Tff+cxJ5Fb/HI83/l8OHDZ4z/4osv6NatG59++qkDaZ3nqdfp9PWkv3An+2f9P/Z+9U8ee+1DcnNzS40VEe644w6mTJlCVlaWQ4md5alX/uEM0l+4k33vPsLer/7Jb1+fTX5+fvG4OnXqMGHCBG6++WZ27tzpXGCHeepVkH2M9OfvYu8/xrNn8V+Z8vK75OTkAEV969577+Wqq646t5NSVa1woehsfDvQDqgLrAa6lBnTCVjsHhsFrAMurmi/PXv21MpoO2m+tnEvUR0vV4qeNZyxxMbG6oABA3TcuHHat2/f4u1hYWE6YsQI3bp1a6WOW5N5atag+/Vea5WYmKijRo3SN998Uzdu3KhLliwpvm/QoEG6bt06p7+EgPLUq/Fld51Rq6ioKL322mt16tSpumzZMs3Ly9P7779fAU1ISNAPP/xQCwsLnf4SAspTrybX/PKMejVs2FBvvPFGfe6553TNmjV6zz33KKCRkZH61FNP6alTp5yOH3CeesUMmXxGverWrav9+/fXYcOGFW+LiIjQ8ePH6/Hjx0vtB0hVH31b1I9TfhEZDDwPhANvq+pTIjLG/YvhVfeYicDPgULgTVV9vqJ9pqSkaGpqqs9je/SdtgRXZtFvteyt/+VU+lryDuwg/9BO8rOO+b2f8PBwRo4cyaOPPkrbtm39flxN5KlZ9rbl5KT9l9MZG8k7tJszZ9KKNGzYkBMnThSvh4eHM3r0aJ544gkqO3VWE3nqlbNzFdmbvuHU7jXkH93rdWyDBg1o1qwZu3btKt527bXX8tJLL3HRRWfMQoYkT71OuzZycv1/OLVzFflHyz6ZLxIWFkZhYWHxemJiIi+//DIDBgwIVFzHeeqVe2A7J9cs4tTuNeQd3Onzca1ateK5557j9ttvR0QQkR9VNaWix/jV2KtDZRu7Z37KMx0DEFknnKdvuZg+rSJYvXo1a9asYc2aNaxevZqNGzeWejpYVkREBPfddx9TpkyhdevW5Y6rybzVrG5BDsPbnkb3b+a7775j2bJlPqcSGjduzGOPPcbYsWOpV69edcd2jLd6RWQf4cbYIxzfsZr//Oc/PqcSPNMOU6ZMoX79+tWc2Fnl1Wtws0McTVvB4sWL2bvX+y9Gj+HDh/Pss8/SsmXL6o7rOG/1qpN7gqEtjnFyxyqWLFnCli1byn38Nddcw5///Gc6duzos7H7nIqprqWyUzGqqnNWZOhlUxdr20nz9bKpi3XOioxyx3766aflTtdQ5inQuHHjzni6Eyp81SwvL09XrFihL730kjZv3rzCWrVv315nz54d0lMOvuq1Y8cO/etf/6q33XZbhbVq3bq1fvDBByFdK9WK61VYWKgbNmzQX/7yzKmakkujRo30xRdf1Ly8PAe/ksCoqF5z5sxREamwVnXq1Km6qZjqUNkz9srYt28f3bt3Z//+/YSHh9OqVStat25N69atiY+PL77tWT///PMJC6vdn67wzjvvMHLkSL/GXnPNNbz66qu0b9++ekMFqYKCAm699VY++ugjn2MHDhzISy+9RGJiYgCSBZ/du3fTu3dvn2fuAMnJybzyyitcemnZd1OHvh9++IH+/fsXv4gaGRlJVFSU1+WLL77wecbuz/vYa5xjx44xd+5c4uPjadmyJeHh4U5HCmoul4sPP/yQO++8kyZNmtC0aVOaNGlSvJRdb9CgQa3+G4FXXnmFnTt3ctlll1G/fn3q169PgwYNim+XXTZu3Ej79u2JiAjJH7cKzZkzh9tuu43IyEi/lvr169fKv0Fp3749u3fvJioqivPOO6/CE01/ahOSZ+zGGBOq/HnxtHbPPxhjTAiyxm6MMSHGGns1Sk9P56qrrqJTp0506dKFF154welIxphaoPa9mhNAERERPPvss/To0YMTJ07Qs2dPBg4cSOfOnZ2OZowJYXbGXo1atmxJjx49gKK/6uzUqRMul/cP4DLGmKpijT1Adu7cycqVK2vle3SNMYFlUzFVzNvnLV/ToTG33norzz//PI0aNXI6ojEmxFljr0JlPwvClZnD5H+vJPI/f+Tee+5h2LBhDic0xtQGNhVThUp+ZjwUfQ5Pxsd/Yn9YM8aNG+dgMmNMbWKNvQrtcX+ssMdp1way1v+HQ1tX0L17d7p3786CBQscSmeMqS1sKqYKtYqOLP7MeIDz4rvQZtJ84qIjWTr5ageTGWNqEztjr0ITByUSWaf0B45F1gln4qDa+cl+xhhn+NXYReQ6EdksImkiMtnL/f1F5JiIrHIvv636qMFvaHIcU4d1JS46EgHioiOZOqyrXbXdGBNQPqdiRCQceBkYSNFFq5eLyMequqHM0G9U9cZqyFijDE2Os0ZujHGUP2fsvYA0Vd2uqrnALGBI9cYyxhhztvxp7HFAeon1DPe2svqIyGoR+VREunjbkYiMFpFUEUk9ePDgWcQ1xhjjiz+N3dvlOspenWMF0EZVuwEvAXO97UhVX1fVFFVNqQ1XvTfGGCf409gzgNYl1uOBPSUHqOpxVT3pvr0AqCMiMVWW0hhjjN/8aezLgQ4i0k5E6gJ3AR+XHCAiLcR9IT4R6eXe7+GqDmuMMcY3n++KUdV8ERkLLATCgbdVdb2IjHHf/ypwG/ArEckHcoC71KmLqRpjTC1nF7M2xpgaxC5mbYwxtZA1dmOMCTHW2I0xJsRYYzfGmBBjjd0YY0KMNXZjjAkx1tiNMSbEWGM3xpgQY43dGGNCjDV2Y4wJMdbYDQCnTp2iV69edOvWjS5duvD44487HckYc5Z8fgiYqR3q1avHkiVLaNCgAXl5efTr14/rr7+e3r17Ox3NGFNJdsZuABARGjRoAEBeXh55eXm4P4nZGFPDWGM3xQoKCujevTvNmzdn4MCBXHrppU5HMsacBZuKqcXmrnQxY+Fm9mTm0Co6komDElm1ahWZmZnccsstrFu3josvvtjpmMaYSrIz9lpq7koXj8xeiyszBwVcmTk8Mnstc1e6iI6Opn///nz22WdOxzTGnAW/GruIXCcim0UkTUQmVzDuEhEpEJHbqi6iqQ4zFm4mJ6+geL0g+xhZJ44Vbc/JYdGiRXTs2NHBhMaYs+VzKkZEwoGXgYEUXdh6uYh8rKobvIx7hqJL6Jkgtyczp9R6wckjHPrkOfZpIZfMrM8dd9zBjTfe6FA6Y8y58GeOvReQpqrbAURkFjAE2FBm3IPAh8AlVZqwBG9zwkOT46rrcCGhvJq1io7EVaK5123ejlY/f5G46EiWTr7awcTOsu+xyrF6VU5F9Tp9+jR169atknej+TMVEwekl1jPcG8rJiJxwC3AqxXtSERGi0iqiKQePHiwUkErmhMuz9NPP823335bqeOEkopqNnFQIpF1wkuNj8g+wviBHZwJGwQq8z2mqhw5ciTwIYOIv/VKT09n1apVjmQMJr7qdezYMfr06cOiRYvO+Vj+NHZvvz7KXgH7eWCSqhZ4GfvTg1RfV9UUVU2JjY31M2KRknPCWZu+5dCCF9j3zXtM/tNbrFu3jpycnDMeExUVxeWXX06/fv2YP38+hYWFlTpmTeep2amMDRxe+DInVn1GZvpmnvlkHUOT45g6rCtx0ZEIEBcdya0Jp3hi1I188sknOHWRcyd56pV3OJ3DC1/m5NrFHN+3i+mfbTpjrIhw00038eyzz3L69GkH0jrPU6+CrKMcWvACJ1Z9xjFXGtM/Lf1kvlmzZvTu3ZuRI0eSkZHhUFrneepVmHuKg/NmcPyH2RxJW8HUuakANG/enPz8fAYOHMiAAQNYtmzZWR/Ln6mYDKB1ifV4YE+ZMSnALPdTiBhgsIjkq+rcs05WRsk54VO715C19gsAMoGuMx9HREhISKBDhw5cdNFFdOjQgcjISACWLl3KTTfdRJcuXZg0aRJ33XUXderUqapoQctTs1O7VnNy1afF2/eFRdBzThI9e/bk3h496DmgJ127duXUqR48O/lX3HjjjfTt25epU6dy+eWXOxU/4Irrlb6Ok6s+La7ZvvMaMPiby+nduze9e/emV69eREdH0717dyZMmMDLL7/MtGnTuP3222vVH3V56nXatYmstV8U/0zuqxvJ1Yt6c+mll9K7d9G/l1xyCe+88w7vvfce48eP5+GHH6ZRo0ZOxg84T73yDu4ge8NXZG/4CoADQLu/tyU5OZn8/HwAlixZQp8+fbj55pv5wx/+QNeuXSt3MFWtcKGo+W8H2gF1gdVAlwrG/w24zdd+e/bsqZVx2dTF2mbSfG0zab427HmThp3XQCl65lDpJSEhQV988UXNysqqVIaaxlOzRr2GqUTUq7AmERER2q1bN42MjCy1ffDgwbpy5Uqnv5SA8NQr+ooRPuvVqVMn7dGjR6ltvXv31m+//dbpLyNgPPVqOmisSt1In99fJddjY2P1L3/5i+bm5jr9ZQSMp16xwx7TsKjGfvcrEdG7775bt27dqqqqQKr66K+ifjzlFpHBFE23hANvq+pTIjLG/Yvh1TJj/wbMV9UPKtpnSkqKpqam+jy2h2d+quRb9OrmZTGq63m0Cstky5YtbNmyha1bt7Jlyxays7N97jMmJoYHH3yQsWPH0rRpU7+z1BQla6aFRVMMHNpBj/pHOZa+hZUrV5KVleXXvoYPH86TTz7JhRdeWM2pnVOqXgX55B7cie7fQsewfbi2rCEtLc2v/dx6661MmzYtpGsF3r+/dN8WLq57gL1b17JhwwafU3odO3bkmWee4aabbgr5Zzul6qVKwYnDcHgHlzc5Qc6+baxYsYL09PRyHx8REcF9993Ha6+99qOqplR4MF+dv7qWyp6xq6rOWZGhl01drG0nzdfLpi7WOSsyvI4rLCzUjIwMHTx4sF+/ETt27Kjz5s2rdJ6aoKKa5efn68aNG3XmzJk6btw4vfjii32edY0ZM0ZdLpeDX1H1qqheBw4c0Hnz5umUKVN0wIABKiLl1qpOnTr60EMP6eHDhx38aqpfRfU6duyYLlq0SEeOHOnzZ/DKK6/U5cuXO/iVBEZF9XrzzTf9PYuvmjP26lDZM/bK+vLLL7n66quLzxhiY2OL595L/nvhhRcSFRVVbTlqiuzsbHr37s3atWsrHBceHk67du2YOnUqt956a8ifZZXnjTfeYPTo0T7HRUdH89hjj/HAAw9Qr169ACQLLseOHePSSy9l8+bNFY5r3LgxsbGx/O///i+//vWvCQ8Pr3B8qFm1ahW9e/cmPz+fli1b0qpVK1q1alXqtme9e/fuPs/YQ/azYnbs2MHMmTOLm3jjxo2djhS0VJUJEyaQnZ1Nv379aNGiBS1btixeSq7HxMQQFla7P4li6dKljB8/nri4OJo1a0azZs2IiYkp9W/Z206dQDlt5syZXHLJJVx//fXExMR4XZo2bVor3sxQkdjYWHbt2kVsbGyV/HyF7Bm78Z/ne6C2nn1XVl5eHhEREVYv4wgRqb1n7MZ/1qAqp7afXZrgV7ufUxtjTAiyxm6MMSHGGrsxxoQYa+zGGBNirLEbY0yIscZujDEhxhq7McaEGGvsxhgTYqyxG2NMiLHGbowxIcYauzGmWowaNYrmzZtz8cUXOx2l1rHGboypFiNHjuSzzz5zOkat5FdjF5HrRGSziKSJyGQv9w8RkTUiskpEUkWkX9VHNcbUJFdccUVIXpmsJvD56Y4iEg68DAyk6MLWy0XkY1UteSnyxcDHqqoikgS8D3SsjsDGGGMq5s/H9vYC0lR1O4CIzAKGAMWNXVVPlhhfn6LLNxljapm5K13MWLiZPZk5tIqO5H+62tXJnOBPY48DSl5hNQO4tOwgEbkFmAo0B27wtiMRGQ2MBkhISKhsVmNMECt7wXlXZg7PfJZO3ql8h5PVPv7MsXu7CsMZZ+SqOkdVOwJDgd9725Gqvq6qKaqaEhsbW6mgxpjgNmPh5uKm7nE6v4BDJ087lKj28qexZwCtS6zHA3vKG6yqXwPtRSTmHLMZY2qQPZk5pdYPfjydff+YQM7BdOLj43nrrbccSlb7+DMVsxzoICLtABdwF3B3yQEiciGwzf3iaQ+gLnC4qsMaY4JXq+hIXCWae+zNDwMQFx3J0slXOxWrVvJ5xq6q+cBYYCGwEXhfVdeLyBgRGeMediuwTkRWUfQOmju1tl6W3ZhaauKgRCLrhJfaFlknnImDEh1KVHuJU/03JSVFU1NTHTm2MaZ6lH1XzMRBiQxNjnM6VkgRkR9VNaWiMf5MxRhjjF+GJsdZIw8C9pECxhgTYqyxG2NMiLHGbowxIcYauzHGhBhr7MYYE2KssRtjTIixxm6MMSHGGrsxxoQYa+zGGBNirLEbY0yIscZujDEhxhq7McaEGGvsxhgTYqyxG2NMiLHGbowxIcavxi4i14nIZhFJE5HJXu6/R0TWuJfvRKRb1Uc1xhjjD5+NXUTCKbrc3fVAZ2C4iHQuM2wHcKWqJgG/B16v6qDGGBOK1q1bx8mTJ6t0n/6csfcC0lR1u6rmArOAISUHqOp3qnrUvboMiK/SlG5zV7roO20J7SZ/Qt9pS5i70uV13IkTJxgxYgTffPMNtf3Sq/7ULCsri2XLljmQLvj4U68vv/ySgoICB9IFn4rq9cMPP/DUU09x7NgxBxMGF2/1Sk9PJz4+nvHjx7N9+/YqOY4/jT0OSC+xnuHeVp77gE/PJZQ3c1e6eGT2WlyZOeQecbFt3Y9MeHsR//5hxxljGzZsSHZ2NldccQXJycm8+eabZGdnV3WkoOep2a4MF6f2pZF+4CiPzF57RrOKiopixIgRDBw4kK+//tqhtM7z1Gv3voNF9TqY6bVe//rXv0hKSuLf//43hYWFDqV1nqde6QeOkpOxkfR9B0vVq1u3bkybNo22bdvy+OOPc+TIEYcTO8tTr4xDx8jesZKd27YwadZysmM6c9555/GnP/2JCy+8kJtvvplFixad00mpz4tZi8jtwCBVvd+9fi/QS1Uf9DL2KuAvQD9VPezl/tHAaICEhISeu3bt8jto32lLcGXmAHD0P29z/IfZnp3S4vzziY+PL7Vs27aNN954o/jxTZo04f777+dXv/oV7dq18/u4NZmnZsd/nMfRRa8BEN74fBq2aMv9N11Op06d6Ny5M506deKpp55ixowZAFx++eU89thjXHPNNYiIk19CQHnqlbXpWw59NA0kjDpN42gU155xdw6kW7duJCUlsWLFCoYOHQpA165deeKJJxg6dGitqhX8VK9Tu9ey/91HAAhv0JQGLdryP4P70aVLF9544w08F61v2LAhY8eOZdy4ccTExDgZ3RGeeuUe3Mnet8cWb4+IbEhdKTjj5LNz5848+OCD3HvvvdSvX794uz8Xs0ZVK1yAPsDCEuuPAI94GZcEbAMu8rVPVaVnz55aGW0nzdc27iWq05UKnNUiInrTTTfp559/roWFhZXKUNN4atYgebDPujRo0OCMbZdeeqnOmzcv5Ovk4alX48vuqnStkpOTa1WtVH+qV9Nrf12pn8GoqCidMGGC7t271+kvIaA89Wp+2+8qVa/GjRvruHHjdNu2baqqCqSqj/7qzxl7BLAFGAC4gOXA3aq6vsSYBGAJMEJVv6twh24pKSnq+U3uj5Jn7HlHXOQdcVFw4hBReccYkBBBRkYGGRkZpKen+z3tkpiYyNixYxkxYgSNGjXyO0tN4alZ3hEXufvSyDu0m7zD6WhmBnlH9pCfn+/Xfrp3786jjz7KLbfcQlhY6L5Dtrhemfs47dpI3sGd5B7YQcGhXeSdOOMJqFe9evXiySef5Nprrw35M3hPvfJPHCZ3z2ZyD+0i73A6HM0g/0gGubm5FT7+vPPOY/To0Tz88MPExVU0uxsaPPUqOHWS3H1pFJw4RP7xg9TNOsDBlV/4fHx4eDgPPvggzz//vM8zdp+NHUBEBgPPA+HA26r6lIiMAVDVV0XkTeBWwDO3ku/rwJVt7J75qZy8n160iqwTztRhXRma/NM3haqSmZnJwIED+fHHH73uq379+iQlJdGtWze6detG37596dq1q99ZaoqKaja4SyxpaWls2LCBDRs2MH36dLKysircX+fOnZkyZQp33nkn4eHh1R0/4CqqV9/4uqxZs4Y1a9bw4osvsnPnzgr3ddlll/Hkk09y9dVXh2yDr6heN3Y9n/fee4+f/exnPvdTt25dfvOb3/DYY4+VmnIINeXVK2n/Qt5/4/lSYxs1akRSUlKp5eKLL6Zhw4Z+TcVE+BNIVRcAC8pse7XE7fuB+/3Z19nyNO8ZCzezJzOHVtGRTByUWKqpA4gI8+fPL27qCQkJxQ3cs7Rv3z6kzzw9fNWsc+fOdO7cmbfeestrU4+IiKBNmzZccMEFtGvXjgsuuICIiAj27dsXkmdYvuo1YMAAIiIi2L17t9fHR0REEB8fT+vWrYmPj+fzzz+nWbNmdO/ePVBfQkBVVK/jx4/z29/+tnhsvXr1aNu2Le3atSteSq43bdo0ZH8Benir110dhDeeWMwdd9xRqoknJCScUz38OmOvDpU9Y/eXqvKvf/2LuLg4kpKSaNq0aZUfI5Ts3buXESNG0Lx581INvF27dsTHx4fkmfnZys7OZsSIEYSFhdG6deszlvPPP79WnDD4Y/ny5WzZsqW4ebdo0cJq44WqVrqB+3PGHnKN3RhjQpk/jd1+hRpjTIixxm6MMSHGGrsxxoQYa+zGGBNiHHvxVEQO8tP73mOAQ44E8Z9lPHfBng8sY1UJ9ozBng/Kz9hGVWMreqBjjb1UCJFUX6/yOs0ynrtgzweWsaoEe8ZgzwfnltGmYowxJsRYYzfGmBATLI29JlxxyTKeu2DPB5axqgR7xmDPB+eQMSjm2I0xxlSdYDljN8YYU0WssRtjTIhxpLGLSFMR+UJEtrr/bVLOuLdF5ICIrAtgtutEZLOIpInIZC/3i4i86L5/jYj0CFQ2P/N1FJHvReS0iEwIZLZKZLzHXbs1IvKdiHQLwoxD3PlWiUiqiPQLpnwlxl0iIgUiclsg87mP7auG/UXkmLuGq0Tkt97242TGEjlXich6Efkq2DKKyMQSNVzn/v+u+GNrfV1iqToWYDow2X17MvBMOeOuAHoA6wKUK5yiy/tdANQFVgOdy4wZTNHFugXoDfw3gHXzJ19z4BLgKWCCA/+3/mS8DGjivn19IGtYiYwN+Ok1qCRgUzDlKzFuCUXXSrgtCGvYH5gf6O/BSmaMBjYACe715sGWscz4m4Alvvbr1FTMEOAd9+13gKHeBqnq10AgL23eC0hT1e2qmgvMoihrSUOAv2uRZUC0iLQMlnyqekBVlwN5AcpUlj8Zv1PVo+7VZUB8EGY8qe6fJKA+RdefDJp8bg8CHwIHApjNw9+MTvIn493AbFXdDUU/P0GYsaThwLu+dupUYz9fVfcCuP9t7lCOsuKA9BLrGe5tlR1TXZw8tr8qm/E+ip4BBZJfGUXkFhHZBHwCjApQNvAjn4jEAbcAr+IMf/+f+4jIahH5VES6BCZaMX8yXgQ0EZEvReRHERkRsHRF/P55EZEo4DqKfplXyK9L450NEVkEtPBy15TqOmYV8HYpk7Jnav6MqS5OHttffmcUkasoauwBnb/Gz4yqOgeYIyJXAL8HrqnuYG7+5HsemKSqBQ5dUs6fjCso+lyTk+7rJs8FOlR3sBL8yRgB9AQGAJHA9yKyTFW3VHc4t8r8TN8ELFVVn7MY1dbYVbXcHwIR2S8iLVV1r3saw4mnkt5kAK1LrMcDe85iTHVx8tj+8iujiCQBbwLXq+rhAGXzqFQdVfVrEWkvIjGqGogPjvInXwowy93UY4DBIpKvqnMDkA/8yKiqx0vcXiAifwlgDf3K6B5zSFWzgCwR+RroBgSqsVfme/Eu/JiGARx78XQGpV88nV7B2LYE7sXTCGA70I6fXsjoUmbMDZR+8fSHANbNZ74SY3+HMy+e+lPDBCANuMyh7z9/Ml7ITy+e9gBcnvVgyFdm/N8I/Iun/tSwRYka9gJ2B6qGlcjYCVjsHhsFrAMuDqaM7nGNKXq9sb5f+w3kN0OJkM3cxdzq/repe3srYEGJce8Ceyl6ITADuC8A2QZT9Nt6GzDFvW0MMMZ9W4CX3fevBVICXDtf+Vq4a3UcyHTfbhRkGd8EjgKr3EuqA9+DvjJOAta7830P9AumfGXGBryx+1nDse4arqboRfKA/yL3p47ARIreGbMOeChIM44EZvm7T/tIAWOMCTH2l6fGGBNirLEbY0yIscZujDEhxhq7McaEGGvsxhgTYqyxG2NMiLHGbowxIeb/A73xpoC6tbJ6AAAAAElFTkSuQmCC"
>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[3.1022e-02, 9.6896e-01, 1.4652e-08, 5.7400e-07, 2.0014e-05],
        [2.1253e-02, 9.7873e-01, 5.9218e-09, 2.2939e-07, 2.0100e-05],
        [2.1604e-02, 9.7838e-01, 6.2355e-09, 2.4177e-07, 2.0097e-05],
        [2.0795e-02, 9.7918e-01, 5.5124e-09, 2.1322e-07, 2.0104e-05],
        [4.9308e-02, 9.5067e-01, 3.0995e-08, 1.2191e-06, 1.9852e-05]],
       grad_fn=&lt;MmBackward0&gt;)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And this is compared to standard diffusion matrix, which looks like:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">FRED.data_processing</span> <span class="kn">import</span> <span class="n">flashlight_affinity_matrix</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">flashlight_affinity_matrix</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">K</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">(),</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">flow_strength</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x285cbf880&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The grid is working as intended. Although the points have no affinity with each other, in grid land, they can flow into each other.</p>

</div>
</div>
</div>
</div>


